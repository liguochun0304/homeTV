# å†¬ç“œTV (dongguaTV)

ğŸ¬ æ‰“é€ ä½ çš„ç§äºº Netflixï¼TMDb æ™ºèƒ½åˆ®å‰Š + å…¨ç½‘èšåˆ + æé€Ÿæ’­æ”¾

## ğŸŒŸ é¡¹ç›®ç®€ä»‹

å†¬ç“œTVæ˜¯ä¸€ä¸ªåŸºäºNode.jsçš„è§†é¢‘èšåˆå¹³å°ï¼Œé›†æˆäº†30+ä¸ªå½±è§†èµ„æºç«™ç‚¹çš„APIï¼Œæä¾›æ™ºèƒ½æœç´¢ã€èµ„æºèšåˆã€å®æ—¶æµ‹é€Ÿç­‰åŠŸèƒ½ï¼Œè®©ä½ è½»æ¾æ„å»ºä¸ªäººå½±è§†åº“ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **æ™ºèƒ½æœç´¢** - èšåˆ30+å½±è§†ç«™ç‚¹ï¼Œä¸€é”®æœç´¢å…¨ç½‘èµ„æº
- âš¡ **å®æ—¶æµ‹é€Ÿ** - è‡ªåŠ¨æ£€æµ‹å„ç«™ç‚¹å“åº”é€Ÿåº¦ï¼Œä¼˜å…ˆæ¨èæœ€å¿«èµ„æº
- ğŸ¯ **å¤šæºèšåˆ** - æ”¯æŒéå‡¡å½±è§†ã€æš´é£èµ„æºã€ç”µå½±å¤©å ‚ç­‰30+ä¸»æµç«™ç‚¹
- ğŸ”¥ **çƒ­é—¨æ¨è** - è‡ªåŠ¨è·å–24å°æ—¶çƒ­é—¨å½±è§†å†…å®¹
- ğŸ¨ **ç®€æ´ç•Œé¢** - å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒPC/ç§»åŠ¨ç«¯å®Œç¾é€‚é…
- ğŸ” **åå°ç®¡ç†** - æ”¯æŒç«™ç‚¹å¼€å…³é…ç½®ï¼Œè‡ªå®šä¹‰èµ„æºæº
- ğŸ“Š **æ•°æ®æŒä¹…åŒ–** - JSONæ•°æ®åº“å­˜å‚¨ï¼Œæ”¯æŒè‡ªå®šä¹‰é…ç½®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js â‰¥ 16.0
- npm â‰¥ 6.0

### å®‰è£…éƒ¨ç½²
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/dongguaTV.git
cd dongguaTV

# å®‰è£…ä¾èµ–
npm install

# é…ç½®TMDB_API_KEY ç¼–è¾‘ index.html 
const TMDB_API_KEY = "æ›¿æ¢æˆä½ è‡ªå·±çš„KEY"; 
# é…ç½® TMDB_API_KEY ä¸ºä½ è‡ªå·±çš„TMDb APIå¯†é’¥

# å¯åŠ¨æœåŠ¡
npm start
# æˆ–
node server.js
```

### Docker æ–¹å¼
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/dongguaTV.git
cd dongguaTV
# ç¼–è¯‘å’Œå¯åŠ¨
docker compose up -d --build
```
### è®¿é—®åº”ç”¨
- å‰ç«¯é¡µé¢: http://localhost:3000
- åå°ç®¡ç†: http://localhost:3000/admin.html
- ç®¡ç†å‘˜å¯†ç : `admin`

## ğŸ“¡ APIæ¥å£

### æœç´¢æ¥å£
```
GET /api/search?wd=å…³é”®è¯
```

### è¯¦æƒ…æ¥å£
```
GET /api/detail?site_key=ç«™ç‚¹key&id=å½±ç‰‡ID
```

### çƒ­é—¨æ¨è
```
GET /api/hot
```

### ç«™ç‚¹æµ‹é€Ÿ
```
GET /api/check?key=ç«™ç‚¹key
```

### ç®¡ç†æ¥å£
```
POST /api/admin/login              # ç®¡ç†å‘˜ç™»å½•
GET  /api/admin/sites              # è·å–ç«™ç‚¹é…ç½®
POST /api/admin/sites              # æ›´æ–°ç«™ç‚¹é…ç½®
```

## ğŸ›ï¸ å†…ç½®ç«™ç‚¹

å¹³å°é›†æˆäº†ä»¥ä¸‹30+ä¸ªå½±è§†èµ„æºç«™ç‚¹ï¼š

| ç«™ç‚¹åç§° | çŠ¶æ€ | ç‰¹ç‚¹ |
|---------|------|------|
| éå‡¡å½±è§† | âœ… | èµ„æºä¸°å¯Œï¼Œæ›´æ–°å¿«é€Ÿ |
| æš´é£èµ„æº | âœ… | é«˜æ¸…èµ„æºå¤š |
| ç”µå½±å¤©å ‚ | âœ… | ç»å…¸è€ç‰Œç«™ç‚¹ |
| å¤©æ¶¯èµ„æº | âœ… | ç¨³å®šå¯é  |
| 360èµ„æº | âœ… | æ¥å£ç¨³å®š |
| é‡å­èµ„æº | âœ… | è“å…‰é«˜æ¸… |
| è±†ç“£èµ„æº | âœ… | è¯„åˆ†å‡†ç¡® |
| çˆ±å¥‡è‰º | âœ… | æ­£ç‰ˆèµ„æº |
| ... | ... | ... |

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒé…ç½®
```javascript
const PORT = 3000;              // æœåŠ¡ç«¯å£
const ADMIN_PASSWORD = "admin"; // ç®¡ç†å‘˜å¯†ç 
const FORCE_UPDATE = true;      // æ˜¯å¦å¼ºåˆ¶æ›´æ–°ç«™ç‚¹é…ç½®
```

### ç«™ç‚¹é…ç½®
ç«™ç‚¹é…ç½®å­˜å‚¨åœ¨ `db.json` æ–‡ä»¶ä¸­ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
```json
{
  "sites": [
    {
      "key": "ffzy",
      "name": "éå‡¡å½±è§†",
      "api": "https://api.ffzyapi.com/api.php/provide/vod",
      "active": true
    }
  ]
}
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express.js
- **å‰ç«¯**: HTML5 + CSS3 + JavaScript
- **æ•°æ®å­˜å‚¨**: JSONæ–‡ä»¶æ•°æ®åº“
- **HTTPè¯·æ±‚**: Axios
- **è·¨åŸŸå¤„ç†**: CORS
- **ç¼“å­˜**: Node-cache

## ğŸ“± ç•Œé¢é¢„è§ˆ

### ä¸»ç•Œé¢
- æœç´¢æ¡†ï¼šæ”¯æŒå…³é”®è¯æœç´¢
- çƒ­é—¨æ¨èï¼šå±•ç¤º24å°æ—¶çƒ­é—¨å†…å®¹
- æœç´¢ç»“æœï¼šæ˜¾ç¤ºå¤šæºèšåˆç»“æœ
- è¯¦æƒ…é¡µé¢ï¼šå±•ç¤ºå½±ç‰‡è¯¦ç»†ä¿¡æ¯å’Œæ’­æ”¾é“¾æ¥

### ç®¡ç†åå°
- ç«™ç‚¹ç®¡ç†ï¼šå¼€å…³å„èµ„æºç«™ç‚¹
- é…ç½®ç®¡ç†ï¼šè‡ªå®šä¹‰APIæ¥å£
- ç³»ç»ŸçŠ¶æ€ï¼šæŸ¥çœ‹æœåŠ¡è¿è¡ŒçŠ¶æ€

## ğŸ”’ å®‰å…¨è¯´æ˜

- å»ºè®®ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Nginxåå‘ä»£ç†
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…ä»¥ç¡®ä¿å®‰å…¨æ€§

## ğŸ“ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚ä½¿ç”¨æœ¬é¡¹ç›®äº§ç”Ÿçš„ä»»ä½•æ³•å¾‹é—®é¢˜ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚è¯·æ”¯æŒæ­£ç‰ˆå½±è§†å†…å®¹ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥å®Œå–„é¡¹ç›®ï¼

### å¼€å‘è®¡åˆ’
- [ ] æ·»åŠ æ›´å¤šå½±è§†èµ„æºç«™ç‚¹
- [ ] æ”¯æŒç”¨æˆ·æ”¶è—å’Œå†å²è®°å½•
- [ ] æ·»åŠ æ’­æ”¾å†å²åŒæ­¥åŠŸèƒ½
- [ ] æ”¯æŒå¤šç”¨æˆ·ç³»ç»Ÿ
- [ ] æ·»åŠ å½±è§†æ¨èç®—æ³•

## ğŸ“„ å¼€æºåè®®

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶
# flask-api-demo

## é¡¹ç›®åˆå§‹åŒ–

æ‰§è¡Œ`sh init.sh PROJECT_NAME`

## å¼€å‘è¯´æ˜

1. ä¿®æ”¹`build.sh`å’Œ`docker-compose.yml`ä¸­é•œåƒç‰ˆæœ¬ï¼Œæ‰§è¡Œ`sh build.sh`æ„å»ºé•œåƒ
2. æ‰§è¡Œ`docker-compose up -d`å¯åŠ¨å®¹å™¨
3. æ‰§è¡Œ`docker exec -it flask-api-demo bash`è¿›å…¥å®¹å™¨
4. æ‰§è¡Œ`supervisorctl stop webapp`åœæ­¢æœåŠ¡ï¼Œå¹¶æ‰§è¡Œ`flask run`æˆ–`python wsgi.py`è¿›å…¥å¼€å‘è€…æ¨¡å¼
5. åœ¨`CHANGELOG.md`ä¸­è®°å½•ç‰ˆæœ¬æ—¥å¿—ï¼Œé‡æ–°æ‰§è¡Œç¬¬ä¸€æ­¥å‘å¸ƒé•œåƒ

## è¿ç»´è°ƒè¯•

1. è¿›å…¥å®¹å™¨åä½¿ç”¨`supervisorctl status`è¿›ç¨‹çŠ¶æ€

   ```bash
   # supervisorctl status
   webapp                              RUNNING   pid 8, uptime 3 days, 5:35:50
   worker                           RUNNING   pid 10, uptime 3 days, 5:35:50
   ```
   
2. åœæ­¢è¿›ç¨‹ï¼š`supervisorctl stop webapp`
3. å¯åŠ¨è¿›ç¨‹ï¼š`supervisorctl start webapp`
4. æŸ¥çœ‹æ—¥å¿—ï¼š`tail -f /data/log/webapp.log`
5. æŸ¥çœ‹æ—¥å¿—ï¼š`tail -f /data/log/worker.log`

## éƒ¨ç½²è¯´æ˜

1. åˆ›å»º`flask`ç½‘ç»œï¼š`docker network create flask`

   å¯èƒ½é‡åˆ°ç½‘ç»œå†²çªé—®é¢˜ï¼Œè§£å†³æ–¹æ³•ï¼š
   1. åˆ é™¤ç½‘ç»œï¼š`docker network rm flask`
   2. åˆ›å»ºç½‘ç»œæ—¶æŒ‡å®šæ©ç å’Œç½‘å…³ï¼š
   
      `docker network create --subnet=192.168.0.0/24 --gateway=192.168.0.1 flask`

2. å‡†å¤‡`docker-compose.yml`, æ³¨é‡Šæºç æŒ‚è½½ï¼š`- "./:/work"`

3. å¯åŠ¨æœåŠ¡ï¼š`docker-compose up -d`

4. æ•°æ®åº“è¿ç§»ï¼š

    1. docker exec -it flask-api-demo bash
    2. flask db init -d /data/data/migrations
    3. flask db migrate -d /data/data/migrations
    4. flask db upgrade -d /data/data/migrations

5. åˆå§‹åŒ–æ•°æ®åº“ï¼š

   ```bash
   flask init_db
   ```

## Dockeré…ç½®æ–‡ä»¶

1. vim /etc/docker/daemon.json
   
   - default-runtimeï¼šä¿®æ”¹é»˜è®¤è¿è¡Œæ—¶ä¸ºnvidia
   - data-rootï¼šä¿®æ”¹æ•°æ®å­˜å‚¨è·¯å¾„
   - bipï¼šä¿®æ”¹ç½‘å¡åœ°å€
   
   ```json
   {
       "default-runtime": "nvidia",
       "runtimes": {
           "nvidia": {
               "path": "nvidia-container-runtime",
               "runtimeArgs": []
           }
       },
       "data-root":"/data/docker_data",
       "bip":"192.168.0.1/24"
   }
   ```